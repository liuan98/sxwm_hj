(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/goods/video"],{"1a7d":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=o(e("a34a")),r=e("2f62"),n=o(e("125c"));function o(t){return t&&t.__esModule?t:{default:t}}function a(t,i,e,s,r,n,o){try{var a=t[n](o),c=a.value}catch(h){return void e(h)}a.done?i(c):Promise.resolve(c).then(s,r)}function c(t){return function(){var i=this,e=arguments;return new Promise(function(s,r){var n=t.apply(i,e);function o(t){a(n,s,r,o,c,"next",t)}function c(t){a(n,s,r,o,c,"throw",t)}o(void 0)})}}function h(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,s)}return e}function u(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?h(e,!0).forEach(function(i){l(t,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):h(e).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})}return t}function l(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var d=function(){return e.e("components/page-component/goods/app-goods-video").then(e.bind(null,"9eb5"))},p=function(){return e.e("components/page-component/app-member-mark/app-member-price").then(e.bind(null,"dd88"))},f=function(){return e.e("components/page-component/app-sup-vip/app-sup-vip").then(e.bind(null,"348c"))},_=function(){return e.e("components/page-component/app-attr/app-attr").then(e.bind(null,"d3c4"))},g=function(){return e.e("components/basic-component/app-iphone-x/app-iphone-x").then(e.bind(null,"7598"))},v=function(){return e.e("components/page-component/app-pt-attr/app-pt-attr").then(e.bind(null,"051f"))},m={components:{videoNew:d,appPtAttr:v,"app-member-price":p,"app-sup-vip":f,"app-attr":_,"app-iphone-x":g},data:function(){return{buyText:"立即购买",sign:"",cartShow:1,plugin:"",buyBool:!1,previewUrl:"",submitUrl:"",show_pt:!1,pt:!0,selectGroupAttrId:-1,pintuan_groups:[],appAttr:{},translateX:"10",height:"667px",cur_index:null,width:"",sysheight:0,containerStyle:"transform:translateY(0px)",distance:0,listTouchStartY:0,listTouchDirection:null,scroll:!1,videoList:[],clicktime:0,goodBool:!1,goods_list:[],page:1,goods_id:0,show:0,item:null,selectAttr:{},attrGroup:[],ne:0,pre:0}},computed:u({},(0,r.mapGetters)("iPhoneX",{getEmpty:"getEmpty"})),onLoad:function(i){var e=this;switch(this.goods_id=i.goods_id,this.sign=i.sign,this.sign){case"advance":this.cartShow=0,this.buyText="支付定金",this.buyBool=!0;break;case"booking":this.cartShow=0,this.buyText="立即预约",this.plugin="booking",this.submitUrl=this.$api.book.order_submit,this.previewUrl=this.$api.book.order_preview;break;case"miaosha":this.submitUrl=this.$api.miaosha.order_submit,this.previewUrl=this.$api.miaosha.order_preview;break;case"pintuan":this.$request({url:this.$api.pt.detail,data:{id:this.goods_id,group_id:0}}).then(function(t){e.item=t.data.detail,e.selectGroupAttrId=e.item.pintuan_groups[0].id});break;case"integral_mall":this.cartShow=0,this.buyText="立即兑换",this.submitUrl=this.$api.integral_mall.order_submit,this.previewUrl=this.$api.integral_mall.order_preview;break;case"step":this.cartShow=0,this.buyText="立即兑换",this.submitUrl=this.$api.step.order_submit,this.previewUrl=this.$api.step.order_preview;break;case"gift":this.cartShow=0,this.buyBool=!0,this.buyText="加入礼包";break;case"mch":this.submitUrl=this.$api.mch.order_submit,this.previewUrl=this.$api.mch.order_preview;break;default:break}this.getVideo(i.goods_id);var s=t.getSystemInfoSync();this.height="".concat(s.windowHeight,"px"),this.width="".concat(s.windowWidth,"px"),this.sysheight=s.windowHeight},onHide:function(){this.videoCtx=t.createVideoContext("video_".concat(this.videoList[this.cur_index].video_id),this),this.videoCtx.pause()},onShow:function(){null!==this.cur_index&&this.videoList[this.cur_index].flag&&(this.videoCtx=t.createVideoContext("video_".concat(this.videoList[this.cur_index].video_id),this),this.videoCtx.play())},methods:{buyClick:function(t){(0,n.default)(t,this.sign,this,this.goods_list[this.cur_index]),console.log(t)},submit:function(){var i=this.item,e=this.appAttr.number,s=this.selectAttr;return s?e<=0?(t.showModal({title:"提示",content:"商品数量不能为0",showCancel:!1}),!1):!!i:(t.showModal({title:"提示",content:"请先选择规格",showCancel:!1}),!1)},onAttr:function(t){this.selectAttr=t},specification:function(t){this.attrGroup=t.attr_groups,this.show=Math.random(),"pintuan"===this.sign?(this.show_pt=!0,this.request_pt(this.selectGroupAttrId)):this.item=t},setGroupAttrID:function(t){this.selectGroupAttrId=t,this.selectAttr={},this.request_pt(t)},attr:function(t){this.appAttr=t,console.log(t)},buy:function(){if(!this.submit())return!1;var i=this.item,e=this.appAttr.number,s=this.selectAttr,r=s.id,n=[];for(var o in s.attr_list)n.push({attr_id:s.attr_list[o].attr_id,attr_group_id:s.attr_list[o].attr_group_id});var a=[],c={mch_id:i.mch_id?i.mch_id:0,goods_list:[]};c.goods_list.push({id:i.id,attr:n,num:e,cat_id:0,goods_attr_id:r}),a.push(c),t.navigateTo({url:"/pages/order-submit/order-submit?mch_list="+JSON.stringify(a)})},individual:function(){this.pt?(this.pt=!1,this.selectAttr={},this.request_pt(0)):(0===Object.keys(this.selectAttr).length?t.showToast({title:"请选择规格",icon:"none"}):this.buy(),console.log(this.selectAttr))},multiplayer:function(){if(this.pt){if(this.selectAttr&&0===Object.keys(this.selectAttr).length)t.showToast({title:"请选择规格",icon:"none"});else if(this.selectAttr&&Object.keys(this.selectAttr).length>0){console.log(this.selectAttr);for(var i=this.item.mch_id,e=[],s={id:this.item.id,attr:[],num:this.appAttr.number,goods_attr_id:this.selectAttr.id,cart_id:0},r=0;r<this.selectAttr.attr_list.length;r++){var n={attr_id:this.selectAttr.attr_list[r].attr_id,attr_group_id:this.selectAttr.attr_list[r].attr_group_id};s.attr.push(n)}e.push({mch_id:i,pintuan_order_id:0,pintuan_group_id:this.selectGroupAttrId,goods_list:[s]}),console.log(e),t.navigateTo({url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify(e),"&preview_url=").concat(encodeURIComponent(this.$api.pt.order_preview),"&submit_url=").concat(encodeURIComponent(this.$api.pt.order_submit),"&order_page_url=/plugins/pt/order/order&plugin=pt")})}}else this.selectAttr={},this.pt=!0,this.request_pt(this.selectGroupAttrId)},request_pt:function(){var t=c(s.default.mark(function t(i){var e;return s.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$request({url:this.$api.pt.detail,data:{id:this.goods_id,group_id:i}});case 3:e=t.sent,0===e.code&&(this.item=e.data.detail),t.next=10;break;case 7:throw t.prev=7,t.t0=t["catch"](0),new Error(t.t0);case 10:case"end":return t.stop()}},t,this,[[0,7]])}));function i(i){return t.apply(this,arguments)}return i}(),getVideo:function(){var i=c(s.default.mark(function i(){var e,r,n,o,a,c,h,u,l=this;return s.default.wrap(function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,this.$request({url:this.$api.goods.goods_video_list,method:"get",data:{goodsId:this.goods_id,page:this.page,limit:3}});case 2:if(e=i.sent,0!==e.code){i.next=26;break}for(r=e.data.list,n=!0,o=!1,a=void 0,i.prev=8,c=r[Symbol.iterator]();!(n=(h=c.next()).done);n=!0)u=h.value,this.videoList.push({video_id:u.id,video_url:u.video_url,flag:!1}),this.goods_list.push(u);i.next=16;break;case 12:i.prev=12,i.t0=i["catch"](8),o=!0,a=i.t0;case 16:i.prev=16,i.prev=17,n||null==c.return||c.return();case 19:if(i.prev=19,!o){i.next=22;break}throw a;case 22:return i.finish(19);case 23:return i.finish(16);case 24:null==this.cur_index&&(this.cur_index=0),this.$nextTick().then(function(){l.videoList[l.cur_index].flag=!0,l.videoCtx=t.createVideoContext("video_".concat(l.videoList[l.cur_index].video_id),l),l.videoCtx.play()});case 26:case"end":return i.stop()}},i,this,[[8,12,16,24],[17,,19,23]])}));function e(){return i.apply(this,arguments)}return e}(),routeGo:function(i){t.navigateTo({url:i})},close:function(){t.redirectTo({url:this.goods_list[this.cur_index].page_url})},lower:function(){console.log(1)},clickVideo:function(t){if(this.goodBool=!1,this.clicktime>0&&t.timeStamp-this.clicktime<200)clearTimeout(this.han);else{var i=this;this.han=setTimeout(function(){i.videoList[i.cur_index].flag=!i.videoList[i.cur_index].flag},200)}this.clicktime=t.timeStamp},ListTouchStart:function(t){this.listTouchStartY=t.changedTouches[0].pageY},ListTouchMove:function(t){this.listTouchDirection=this.listTouchStartY-t.changedTouches[0].pageY>10?-1:0,this.listTouchDirection=t.changedTouches[0].pageY-this.listTouchStartY>10?1:this.listTouchDirection;var i=this.distance+t.changedTouches[0].pageY-this.listTouchStartY;i>0||Math.abs(this.listTouchStartY-t.changedTouches[0].pageY)<2&&(this.listTouchDirection=null)},ListTouchEnd:function(t){this.handelVideo(t)},handelVideo:function(){if((0!=this.cur_index||1!=this.listTouchDirection)&&(this.translateX=10,!this.scroll&&this.listTouchDirection)){var t=this.listTouchDirection*this.sysheight+this.distance;if(!(t>0||t<-this.sysheight*(this.videoList.length-1))){var i=!0,e=!1,s=void 0;try{for(var r,n=this.videoList[Symbol.iterator]();!(i=(r=n.next()).done);i=!0){var o=r.value;o.flag=!1}}catch(a){e=!0,s=a}finally{try{i||null==n.return||n.return()}finally{if(e)throw s}}this.animate(t,this.listTouchDirection),this.cur_index=this.cur_index-this.listTouchDirection,this.videoList[this.cur_index].flag=!0,this.videoList.length==this.cur_index+1&&(this.page++,this.getVideo()),this.listTouchDirection=null}}},animate:function(t,i){var e=this,s=this.distance;return new Promise(function(r,n){e.scroll=!0;var o=setInterval(function(){-1===i&&t<s||1===i&&t>s?(s+=100*i,e.containerStyle="transform:translateY(".concat(s,"px)")):(clearInterval(o),s=t,e.distance=t,e.containerStyle="transform:translateY(".concat(s,"px)"),e.scroll=!1,r())},20)})},previous:function(){var t=this;if(0!==this.cur_index){var i=!0,e=!1,s=void 0;try{for(var r,n=this.videoList[Symbol.iterator]();!(i=(r=n.next()).done);i=!0){var o=r.value;o.flag=!1}}catch(c){e=!0,s=c}finally{try{i||null==n.return||n.return()}finally{if(e)throw s}}this.distance=this.distance+this.sysheight;var a=this.distance;this.cur_index=this.cur_index-1,this.containerStyle="transform:translateY(".concat(a,"px)"),clearTimeout(this.pre),this.pre=setTimeout(function(){t.videoList[t.cur_index].flag=!0},300)}},next:function(){var i=this;if(this.cur_index+1!==this.videoList.length){this.distance=this.distance-this.sysheight;var e=this.distance;this.containerStyle="transform:translateY(".concat(e,"px)"),clearTimeout(this.ne),this.ne=setTimeout(function(){i.videoList[i.cur_index].flag=!1,i.cur_index=i.cur_index+1,i.videoList[i.cur_index].flag=!0}),this.videoList.length<this.cur_index+2&&(this.page++,this.getVideo())}else t.showToast({title:"无更多视频",icon:"none"})}},onShareAppMessage:function(){return this.$shareAppMessage({title:this.goods_list[this.cur_index].app_share_title?this.goods_list[this.cur_index].app_share_title:this.goods_list[this.cur_index].name,imageUrl:this.goods_list[this.cur_index].app_share_pic?this.goods_list[this.cur_index].app_share_pic:this.goods_list[this.cur_index].cover_pic,path:this.goods_list[this.cur_index].page_url.split("?")[0],params:{id:this.goods_list[this.cur_index].id}})},watch:{appAttr:{handler:function(t){"none"===t.display&&(this.show_pt=!1)}}}};i.default=m}).call(this,e("c11b")["default"])},2361:function(t,i,e){"use strict";var s=e("df1f"),r=e.n(s);r.a},4048:function(t,i,e){"use strict";var s=function(){var t=this,i=t.$createElement;t._self._c;t._isMounted||(t.e0=function(i){t.goodBool=!t.goodBool})},r=[];e.d(i,"a",function(){return s}),e.d(i,"b",function(){return r})},"548d":function(t,i,e){"use strict";e.r(i);var s=e("4048"),r=e("faaf");for(var n in r)"default"!==n&&function(t){e.d(i,t,function(){return r[t]})}(n);e("2361");var o=e("2877"),a=Object(o["a"])(r["default"],s["a"],s["b"],!1,null,null,null);i["default"]=a.exports},df1f:function(t,i,e){},faaf:function(t,i,e){"use strict";e.r(i);var s=e("1a7d"),r=e.n(s);for(var n in s)"default"!==n&&function(t){e.d(i,t,function(){return s[t]})}(n);i["default"]=r.a}},[["12feb","common/runtime","common/vendor"]]]);