(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/app_admin/order/order"],{"108a":function(e,t,i){"use strict";i.r(t);var n=i("dceb"),s=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,function(){return n[e]})}(a);t["default"]=s.a},"425c":function(e,t,i){"use strict";i.r(t);var n=i("6b64"),s=i("108a");for(var a in s)"default"!==a&&function(e){i.d(t,e,function(){return s[e]})}(a);i("c838");var o=i("2877"),d=Object(o["a"])(s["default"],n["a"],n["b"],!1,null,"0a7fb09e",null);t["default"]=d.exports},"6b64":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.show=!e.show},e.e1=function(t){e.show=!e.show},e.e2=function(t){e.noAddress=!1},e.e3=function(t){e.sendType=0},e.e4=function(t){e.sendType=1})},s=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s})},b85f:function(e,t,i){},c838:function(e,t,i){"use strict";var n=i("b85f"),s=i.n(n);s.a},dceb:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i("2f62");function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(i,!0).forEach(function(t){o(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}for(var d=new Date,r=[],c=[],u=[],h=2015;h<=d.getFullYear();h++)r.push(h);for(var l=1;l<=12;l++)c.push(l);for(var f=1;f<=31;f++)u.push(f);var p={data:function(){return{cancelRefund:!1,time_start:[],noAddress:!1,years:r,months:c,days:u,status:"1",_num:"-1",getFocus:!1,more_list:!1,cityList:[],deliveryId:"0",delivery:"",addressId:"0",refund_price:0,page:1,notRefund:!1,openAddress:!1,isReason:!1,menu:[{name:"待收货",value:"2"},{name:"待退款",value:"4"},{name:"已完成",value:"3"}],active:null,show:!1,start:[],end:[],search:!1,keyword:"",list:[],candidate:[],date_start:"",date_end:"",time:0,inSearch:!1,address:[],today:"",yesterday:"",weekday:"",chooseTime:!1,isRefund:!1,noRefund:!1,confirmOrder:!1,beRemark:!1,remark:null,cancelOrder:!1,detail:{},changePrice:!1,callPhone:!1,custom:!1,mobile:"",isSend:!1,sendType:0,price:0,express:0,msg:!1,searchResult:!1,total:0,about:"",iphone_x:!1}},computed:a({},(0,n.mapState)({theme:function(e){return e.mallConfig.theme},userInfo:function(e){return e.user.info},adminImg:function(e){return e.mallConfig.__wxapp_img.app_admin}})),methods:{clearSearch:function(){this.keyword=""},reload:function(){e.showLoading({title:"加载中..."}),this.page=1,this.list=[],this.getList()},toDetail:function(t,i){e.navigateTo({url:"/pages/app_admin/order-detail/order-detail?id="+t+"&status="+i})},toRefundAdd:function(){this.noAddress=!1,e.navigateTo({url:"/pages/address/address?manual_btn_bg=#446dfd&is_hide_default_btn=1&is_refund_address=1"})},toRedirect:function(t){e.redirectTo({url:t})},toChangeAddress:function(t){e.navigateTo({url:"/pages/app_admin/change-add/change-add?order_no="+t.order_no})},toExpressInfo:function(t){1==t.detail.length&&t.detailExpress[0].express_no?e.navigateTo({url:"/pages/app_admin/express/express?id="+t.id+"&express="+t.detailExpress[0].express+"&express_no="+t.detailExpress[0].express_no+"&customer_name="+t.detailExpress[0].customer_name}):e.navigateTo({url:"/pages/app_admin/express-list/express-list?id="+t.id})},cancel:function(){this.about="",this.date_start="",this.time=0,this.date_end="",this.isRefund=!1,this.chooseTime=!1,this.noRefund=!1,this.changePrice=!1,this.cancelOrder=!1,this.custom=!1,this.callPhone=!1,this.isSend=!1,this.notRefund=!1,this.openAddress=!1,this.isReason=!1,this.confirmOrder=!1,this.addressId=0,this.beRemark=!1,this.remark=null},tabStatus:function(t){var i=this;i.status=t,i.active=null,i.list=[],i.date_start="",i.date_end="",i.keyword="",i.show=!1,i.time=0,i._num="-1",i.page=1,e.showLoading({title:"加载中..."}),i.getList()},toCall:function(e){this.mobile=e,this.callPhone=!this.callPhone},call:function(){e.makePhoneCall({phoneNumber:this.mobile}),this.callPhone=!this.callPhone},toSearch:function(){this.search=!0,this.list=[],this.searchResult=!1,this.candidate=e.getStorageSync("keyword"),this.inSearch=!1},keywordSearch:function(t){this.keyword=t,this.searchResult=!0,e.showLoading({title:"加载中..."}),this.page=1,this.getList()},beOrderConfirm:function(){var t=this;t.$request({url:t.$api.app_admin.confirm,data:{order_id:t.detail.id},method:"post"}).then(function(i){t.$hideLoading(),0==i.code?(e.showToast({title:i.msg,duration:1e3,type:"success",mask:!1}),t.cancel(),setTimeout(function(i){t.page=1,e.showLoading({title:"加载中..."}),t.getList()},1e3)):e.showToast({title:i.msg,icon:"none",duration:1e3})}).catch(function(e){t.$hideLoading()})},beConfirm:function(t){var i=this;i.$request({url:i.$api.app_admin.shou_huo,data:{refund_order_id:i.detail.id},method:"post"}).then(function(t){i.$hideLoading(),0==t.code?(i.cancel(),i.page=1,e.showLoading({title:"加载中..."}),i.getList()):e.showToast({title:t.msg,icon:"none",duration:1e3})}).catch(function(e){i.$hideLoading()})},clear:function(){var t=this;e.removeStorage({key:"keyword",success:function(i){t.candidate=[],e.showToast({title:"清理成功",duration:1e3,type:"success",mask:!1})}})},searchMethod:function(){var t=e.getStorageSync("keyword");0!=this.keyword.length&&(t.length>0?t.unshift(this.keyword):t=[this.keyword],e.showLoading({title:"加载中..."}),this.page=1,this.getList(),t.forEach(function(e,i){t[0]==t[i]&&i>0&&t.splice(i,1)}),e.setStorage({key:"keyword",data:t}),this.inSearch=!0,this.searchResult=!0)},cancelSeacrch:function(){e.showLoading({title:"加载中..."}),this.search=!1,this.keyword="",this.page=1,this.getList()},change:function(e){var t=this;t.time=e,t.custom=!1,4==t.time&&(t.custom=!0,t.date_end=t.today,t.date_start=t.today+" 00:00:00")},toChoose:function(){var t=this;if(e.showLoading({title:"加载中..."}),4!=t.time){switch(t.date_start="",t.date_end=t.today+" 23:59:59",t.time.toString()){case"0":t.date_start="",t.date_end="";break;case"1":t.date_start=t.today;break;case"2":t.date_start=t.yesterday,t.date_end=t.yesterday+" 23:59:59";break;case"3":t.date_start=t.weekday;break}setTimeout(function(){t.page=1,t.getList(),t.chooseTime=!1},300)}else{var i=t.date_end.substring(0,10),n=t.date_start.substring(0,10),s=i.split("-"),a=n.split("-");+s[0]<+a[0]?e.showToast({title:"结束时间不应早于开始时间",icon:"none",duration:1e3}):+s[0]==+a[0]?+s[1]<+a[1]?e.showToast({title:"结束时间不应早于开始时间",icon:"none",duration:1e3}):+s[1]==+a[1]&&+s[2]<+a[2]?e.showToast({title:"结束时间不应早于开始时间",icon:"none",duration:1e3}):(t.page=1,t.getList(),t.chooseTime=!1):(t.page=1,t.getList(),t.chooseTime=!1)}},startChange:function(e){var t=e.detail.value,i=(this.years,this.years[t[0]]),n=this.months[t[1]],s=this.days[t[2]];n>=1&&n<=9&&(n="0"+n),s>=1&&s<=9&&(s="0"+s),this.date_start=i+"-"+n+"-"+s},endChange:function(e){var t=e.detail.value,i=this.years[t[0]],n=this.months[t[1]],s=this.days[t[2]];n>=1&&n<=9&&(n="0"+n),s>=1&&s<=9&&(s="0"+s),this.date_end=i+"-"+n+"-"+s+" 23:59:59"},toTime:function(){var e,t,i=this;i.start=[],i.end=[],e=i.date_start?i.date_start:i.today,t=i.date_end?i.date_end:i.today,i.years.forEach(function(t,n){e.substring(0,4)==i.years[n]&&(i.start[0]=+n)}),i.months.forEach(function(t,n){e.substring(5,7)==i.months[n]&&(i.start[1]=+n)}),i.days.forEach(function(t,n){e.substring(8,10)==i.days[n]&&(i.start[2]=+n)}),i.date_end&&(t=i.date_end),i.years.forEach(function(e,n){t.substring(0,4)==i.years[n]&&(i.end[0]=+n)}),i.months.forEach(function(e,n){t.substring(5,7)==i.months[n]&&(i.end[1]=+n)}),i.days.forEach(function(e,n){t.substring(8,10)==i.days[n]&&(i.end[2]=+n)}),i.chooseTime=!i.chooseTime,i.show=!1},chooseItem:function(t){var i=this;e.showLoading({title:"加载中..."}),i._num=t,i.menu.forEach(function(e,t){e.value==i._num&&(i.active=e)}),i.show=!i.show,i.page=1,i.getList()},tab:function(t){this._num=t,this.show=!1,this.active=null,this.date_start="",this.date_end="",this.keyword="",this.page=1,e.showLoading({title:"加载中..."}),this.getList()},getList:function(){var t,i=this;if(i.loading)return!1;i.loading=!0,i.about="",1==this.status?t=i.$api.app_admin.order:2==this.status&&(t=i.$api.app_admin.refund),i.$request({url:t,data:{status:i._num,date_end:i.date_end,date_start:i.date_start,page:i.page,keyword:i.keyword}}).then(function(t){if(i.$hideLoading(),e.hideLoading(),i.loading=!1,0==t.code){var n=t.data.list;if(2==i.status){n.forEach(function(e){e.detail=[e.detail]});var s=t.data.address;s.forEach(function(e,t){e.address=e.address.replace(/"/g,""),e.address=e.address.replace(/,/g,""),e.address=e.address.replace("[",""),e.address=e.address.replace("]","")}),i.address=s}else n.forEach(function(e){e.order_id=e.id,e.detail.forEach(function(t){1!=t.refund_status&&2!=t.refund_status||(e.have_refund=1)})});i.more_list=!1,n.length==t.data.pagination.pageSize&&(i.more_list=!0),1==i.page?i.list=n:i.list=i.list.concat(n),i.page++,i.$forceUpdate()}else e.showToast({title:t.msg,icon:"none",duration:1e3})}).catch(function(t){i.loading=!1,i.$hideLoading(),e.hideLoading()})},toCancelorder:function(e){this.detail=e,this.cancelOrder=!this.cancelOrder},cancelSubmit:function(){var t=this;e.showLoading({title:"加载中..."}),t.$request({url:t.$api.app_admin.cancel,data:{status:1,remark:"",order_id:t.detail.id},method:"post"}).then(function(i){e.hideLoading(),0==i.code?(e.showToast({title:"取消成功",duration:2e3,icon:"success",mask:!1}),t.isRefund=!1,t.cancelOrder=!1,t.page=1,e.showLoading({title:"加载中..."}),t.getList()):e.showToast({title:i.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})})},toChange:function(e){this.detail=e,this.changePrice=!this.changePrice,this.price=e.total_goods_price,this.express=e.express_price,this.total="￥"+e.total_pay_price},priceInput:function(e){e.detail.value>-.01?this.total="￥"+(+e.detail.value+ +this.express).toFixed(2):this.total="数据有误"},expressInput:function(e){e.detail.value>-.01?this.total="￥"+(+e.detail.value+ +this.price).toFixed(2):this.total="数据有误"},submitChange:function(){var t=this;e.showLoading({title:"加载中..."}),t.price>-.01&&t.express>-.01?t.$request({url:t.$api.app_admin.update_price,data:{order_id:t.detail.id,total_price:t.price,express_price:t.express},method:"post"}).then(function(i){e.hideLoading(),0==i.code?(e.showToast({title:i.msg,duration:2e3,icon:"success",mask:!1}),t.page=1,t.changePrice=!1,t.getList()):e.showToast({title:i.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})}):t.price&&"number"==typeof t.price?t.express&&"number"==typeof t.express||e.showToast({title:"运费必须大于等于0",icon:"none",duration:1e3}):e.showToast({title:"商品总价必须大于等于0",icon:"none",duration:1e3})},toRefundOrder:function(e){var t=this;t.list=[],t.more_list=!1,t.keyword=e,t.status=2,t.search=!0,t.searchMethod()},toSend:function(e){this.detail=e,this.isSend=!0},toExpress:function(t,i){var n=t.id,s=t.refund;n>0?e.navigateTo({url:"/pages/app_admin/send/send?id="+n+"&is_send="+i}):s&&e.navigateTo({url:"/pages/app_admin/send/send?order_refund_id="+s+"&is_send="+i})},toSendType:function(){var t,i=this;1==i.sendType||2==i.detail.send_type?i.detail.status_cn?(e.showLoading({title:"加载中..."}),t={is_express:0,merchant_remark:"",type:i.detail.type,is_agree:1,order_refund_id:i.detail.id},i.$request({url:i.$api.app_admin.refund_handle,data:t,method:"post"}).then(function(t){e.hideLoading(),0==t.code?(e.showToast({title:t.msg,icon:"success",mask:!1,duration:2e3}),i.page=1,i.isSend=!1,i.sendType=0,i.getList()):e.showToast({title:t.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})})):(e.showLoading({title:"加载中..."}),t={is_express:0,words:"",order_id:i.detail.id},2==i.detail.send_type&&(t.man=i.delivery),i.$request({url:i.$api.app_admin.send,data:t,method:"post"}).then(function(t){e.hideLoading(),0==t.code?(e.showToast({title:t.msg,icon:"success",mask:!1,duration:2e3}),i.page=1,i.isSend=!1,i.sendType=0,i.getList()):e.showToast({title:t.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})})):(i.isSend=!1,i.detail.status_cn?e.navigateTo({url:"/pages/app_admin/send/send?order_refund_id="+i.detail.id}):e.navigateTo({url:"/pages/app_admin/send/send?id="+i.detail.id}))},look:function(t){e.previewImage({current:t,urls:[t]})},lookAbout:function(e){this.detail=e,this.isReason=!0},toConfirm:function(e){this.detail=e,this.confirmOrder=!this.confirmOrder},toRefund:function(e){this.detail=e,this.refund_price=e.refund_price,this.isRefund=!this.isRefund},agree:function(){var t=this;e.showLoading({title:"处理中..."}),t.detail.refund_price>0?t.$request({url:t.$api.app_admin.refund_handle,data:{order_refund_id:t.detail.id,type:t.detail.type,is_agree:1,refund_price:t.refund_price,merchant_remark:t.about},method:"post"}).then(function(i){e.hideLoading(),0==i.code?e.showModal({title:"提示",content:i.msg,showCancel:!1,success:function(i){i.confirm&&(t.notRefund=!1,t.openAddress=!1,t.isRefund=!1,t.addressId=0,t.page=1,e.showLoading({title:"加载中..."}),t.getList())}}):e.showToast({title:i.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})}):e.showToast({title:"退款金额需大于零",icon:"none",duration:1e3})},refundHandle:function(e,t,i){1==i&&(this.cancelRefund=!0),1==e?0==this.address.length?this.noAddress=!0:(this.detail=t,this.openAddress=!0):2==e&&(this.detail=t,this.notRefund=!0)},toAgreeCancel:function(e){this.detail=e,this.isRefund=!this.isRefund},decline:function(t){var i=this;if(1==t&&i.addressId<1)return e.showToast({title:"请选择地址",icon:"none",duration:1e3}),!1;i.cancelRefund&&(t=2),e.showLoading({title:"处理中..."}),i.$request({url:i.$api.app_admin.refund_handle,data:{order_refund_id:i.detail.id,type:i.detail.type,is_agree:t,address_id:i.addressId,refund_price:i.detail.refund_price,merchant_remark:i.about},method:"post"}).then(function(t){e.hideLoading(),0==t.code?e.showModal({title:"提示",content:t.msg,showCancel:!1,success:function(e){e.confirm&&(i.page=1,i.notRefund=!1,i.cancelOrder=!1,i.openAddress=!1,i.addressId=0,i.getList())}}):e.showToast({title:t.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})})},chooseAddress:function(e){this.addressId==e?this.addressId="":this.addressId=e},chooseDelivery:function(e){this.getDeliveryId==e.id?this.deliveryId="":(this.deliveryId=e.id,this.delivery="("+e.id+")"+e.name)},noCancel:function(){var t=this;e.showLoading({title:"处理中..."}),t.$request({url:t.$api.app_admin.cancel,data:{status:2,remark:t.about,order_id:t.detail.id},method:"post"}).then(function(i){e.hideLoading(),0==i.code?(e.showToast({title:i.msg,icon:"success",mask:!1,duration:2e3}),t.page=1,t.noRefund=!1,t.getList()):e.showToast({title:i.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading(),e.showToast({title:t,icon:"none",duration:1e3})})},beNotRefund:function(e){this.detail=e,this.noRefund=!this.noRefund}},onReachBottom:function(){this.more_list&&this.getList()},onShow:function(){this.search||(this.page=1,this.getList())},onLoad:function(t){var i=this,n=this;n.$showLoading({type:"global",text:"加载中..."}),n.status="1",n._num="-1";var s=new Date,a=s.getFullYear(),o=s.getMonth()+1;o>=1&&o<=9&&(o="0"+o);var d=s.getDate();n.today=a+"-"+o+"-"+d;var r=Date.parse(new Date),c=1e3*(r/1e3-86400),u=new Date(c),h=u.getFullYear(),l=u.getMonth()+1;l>=1&&l<=9&&(l="0"+l);var f=u.getDate();n.yesterday=h+"-"+l+"-"+f;var p=1e3*(r/1e3-604800),g=new Date(p),m=g.getFullYear(),_=g.getMonth()+1;_>=1&&_<=9&&(_="0"+_);var w=g.getDate();n.weekday=m+"-"+_+"-"+w,e.getSystemInfo({success:function(e){(e.model.indexOf("iPhone X")>-1||e.model.indexOf("iPhone 11")>-1||e.model.indexOf("iPhone11")>-1||e.model.indexOf("iPhone12")>-1||e.model.indexOf("Unknown Device")>-1)&&(n.iphone_x=!0)}}),n.$request({url:n.$api.app_admin.delivery}).then(function(t){0==t.code?(i.cityList=t.data.list,i.deliveryId=t.data.list[0].id,i.delivery="("+t.data.list[0].id+")"+t.data.list[0].name):e.showToast({title:t.msg,icon:"none",duration:1e3})}).catch(function(t){e.hideLoading()}),t.msg&&(n.msg=!0),t.status>-1&&(n._num=t.status),t.refund>0&&(n.status=2),t.no&&("RE"==t.no.slice(0,2)&&(n.status=2),n.search=!0,n.inSearch=!0,n.keyword=t.no,this.getList())}};t.default=p}).call(this,i("c11b")["default"])}},[["d80c","common/runtime","common/vendor"]]]);