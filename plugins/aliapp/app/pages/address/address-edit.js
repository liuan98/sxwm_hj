(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/address/address-edit"],{"0da5":function(t,e,n){"use strict";var r=n("c090"),i=n.n(r);i.a},"0fa7":function(t,e,n){"use strict";n.r(e);var r=n("5a54"),i=n("67cd");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("0da5");var o=n("2877"),s=Object(o["a"])(i["default"],r["a"],r["b"],!1,null,"057ecc67",null);e["default"]=s.exports},"5a54":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.focus=!1})},i=[];n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i})},6744:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n("a34a")),i=n("2f62"),a=o(n("a95b"));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){return d(t)||u(t,e)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(n.push(o.value),e&&n.length===e)break}catch(c){i=!0,a=c}finally{try{r||null==s["return"]||s["return"]()}finally{if(i)throw a}}return n}}function d(t){if(Array.isArray(t))return t}function f(t,e){if(null==t)return{};var n,r,i=l(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function l(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}function h(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(r,i)}function p(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function o(t){h(a,r,i,o,s,"next",t)}function s(t){h(a,r,i,o,s,"throw",t)}o(void 0)})}}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(n,!0).forEach(function(e){_(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(){return Promise.all([n.e("common/vendor"),n.e("components/basic-component/app-layout/app-layout")]).then(n.bind(null,"0b17"))},g=function(){return n.e("components/page-component/app-area-picker/app-area-picker").then(n.bind(null,"8e44"))},y=function(){return n.e("components/basic-component/app-textarea/app-textarea").then(n.bind(null,"47cb"))},w={name:"address-edit",data:function(){return{form:{location:"",latitude:"",longitude:"",id:"",name:"",mobile:"",address:"",province_id:0,city_id:0,district_id:0,detail:""},is_refund_address:0,detail_url:"",list:[],submit_status:!1,tt_area_show:!1,automatic:"",provinceString:"",cityString:"",areaString:"",focus:!1}},computed:v({},(0,i.mapState)({theme:function(t){return t.mallConfig.theme}})),components:{appLayout:b,appAreaPicker:g,appTextArea:y},onLoad:function(e){var n=this;this.getAutoInfo(),this.is_refund_address=e.is_refund_address?e.is_refund_address:0,e.is_refund_address>0?(this.detail_url=this.$api.app_admin.refund_address_edit,t.setNavigationBarTitle({title:"编辑退货地址"})):this.detail_url=this.$api.user.address_detail,e.form&&(this.form=JSON.parse(e.form)),e.id>0?(this.$showLoading({title:"加载中"}),this.$request({url:this.detail_url,data:e}).then(function(r){if(n.$hideLoading(),0===r.code)if(e.is_refund_address>0){var i=r.data.detail;n.getInfo(Object.assign({detail:i.address_detail},i))}else n.form=r.data.list;else t.showToast({title:r.msg,icon:"none"});n.tt_area_show=!0}).catch(function(){n.$hideLoading(),n.tt_area_show=!0})):this.tt_area_show=!0},methods:{outputData:function(t){console.log(t)},getAutoInfo:function(){var t=p(r.default.mark(function t(){var e,n,i,a,o;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$request({url:this.$api.user.auto_address_info,method:"get"});case 2:e=t.sent,0===e.code&&(n=JSON.parse(e.data),i=n.reduce(function(t,e){e.children;var n=f(e,["children"]);return t.concat(n)},[]),a=n.reduce(function(t,e){return t.concat(e.children.map(function(t){t.children;var n=f(t,["children"]);return v({},n,{provinceCode:e.code})}))},[]),o=n.reduce(function(t,e){var n=e.code;return t.concat(e.children.reduce(function(t,e){var r=e.code;return t.concat(e.children.map(function(t){t.children;var e=f(t,["children"]);return v({},e,{cityCode:r,provinceCode:n})}))},[]))},[]),this.provinceString=JSON.stringify(i),this.cityString=JSON.stringify(a),this.areaString=JSON.stringify(o));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getChooseLocation:function(){var e=p(r.default.mark(function e(){var n,i,a,o,c;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=this,e.next=3,t.chooseLocation();case 3:i=e.sent,a=s(i,2),o=a[0],c=a[1],c&&(n.form.location=c.name,n.form.detail=c.address,n.form.latitude=c.latitude,n.form.longitude=c.longitude),o&&function(){t.showModal({title:"授权权限",content:"请先授权地理位置权限",success:function(e){e.confirm&&t.openSetting({success:function(e){e.authSetting["scope.userLocation"]?t.chooseLocation({success:function(t){n.form.location=t.name,n.form.detail=t.address,n.form.latitude=t.latitude,n.form.longitude=t.longitude}}):t.showToast({title:"授权失败",icon:"none"})}})}})};case 9:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),getInfo:function(e){var n=this;this.$request({url:this.$api.user.wechat_district,data:{province_name:e.address[0],city_name:e.address[1],county_name:e.address[2]}}).then(function(t){if(0===t.code){var r=t.data.district,i=r.province,a=r.city,o=r.district;e.province_id=i.id,e.city_id=a.id,e.district_id=o.id,n.form=e}}).catch(function(){t.showToast({title:"网络异常",icon:"none"})})},areaEvent:function(t){t&&(this.form.province_id=t.province.id,this.form.city_id=t.city.id,this.form.district_id=t.district.id,this.list=[t.province.name,t.city.name,t.district.name])},submit:function(){var e=p(r.default.mark(function e(){var n,i,a,o,s,c,u,d,f;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.submit_status){e.next=3;break}return e.abrupt("return");case 3:if(this.form.detail||(n="详细地址不能为空"),this.form.province_id||(n="地区不能为空"),this.form.mobile||(n="联系方式不能为空"),this.form.name||(n="姓名不能为空"),!n){e.next=10;break}return t.showToast({title:n,icon:"none"}),e.abrupt("return");case 10:return this.submit_status=!0,i=this.$api.user.address_save,a=this.form,this.is_refund_address>0&&(i=this.$api.app_admin.refund_address_edit,o=this.form,s=o.id,c=o.name,u=o.mobile,d=o.detail,a={form:JSON.stringify({id:s,name:c,mobile:u,address_detail:d,address:this.list,is_default:0,remark:""})}),e.next=16,this.$request({url:i,data:a,method:"POST"});case 16:f=e.sent,this.submit_status=!1,0===f.code?(t.showToast({title:f.msg,icon:"none"}),t.navigateBack({delta:1})):t.showToast({title:f.msg,icon:"none"}),e.next=25;break;case 21:throw e.prev=21,e.t0=e["catch"](0),this.submit_status=!1,new Error(e.t0);case 25:case"end":return e.stop()}},e,this,[[0,21]])}));function n(){return e.apply(this,arguments)}return n}(),getAddress:function(){var e=(0,a.default)(this.automatic,{},this.provinceString,this.cityString,this.areaString);if(0!==Object.keys(e).length){for(var n=t.getStorageSync("_DISTRICT"),r=e.name,i=e.province,o=e.city,s=e.area,c=e.phone,u=e.detail,d=0;d<n.length;d++)if(n[d].name===i){for(var f=0;f<n[d].list.length;f++)if(n[d].list[f].name===o){for(var l=0;l<n[d].list[f].list.length;l++)if(n[d].list[f].list[l].name===s){this.form.province_id=n[d].id,this.form.city_id=n[d].list[f].id,this.form.district_id=n[d].list[f].list[l].id;break}break}break}this.form.name=r,this.form.detail="".concat(u),this.form.mobile=c}},detailFocus:function(){console.log(22),this.focus=!0}}};e.default=w}).call(this,n("c11b")["default"])},"67cd":function(t,e,n){"use strict";n.r(e);var r=n("6744"),i=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,function(){return r[t]})}(a);e["default"]=i.a},c090:function(t,e,n){}},[["617f","common/runtime","common/vendor"]]]);