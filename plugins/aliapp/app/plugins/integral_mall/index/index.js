(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["plugins/integral_mall/index/index"],{"09db":function(t,n,e){"use strict";var o=e("39d4"),i=e.n(o);i.a},3956:function(t,n,e){"use strict";e.r(n);var o=e("d333"),i=e.n(o);for(var a in o)"default"!==a&&function(t){e.d(n,t,function(){return o[t]})}(a);n["default"]=i.a},"39d4":function(t,n,e){},"525b":function(t,n,e){"use strict";e.r(n);var o=e("5b41"),i=e("3956");for(var a in i)"default"!==a&&function(t){e.d(n,t,function(){return i[t]})}(a);e("09db");var r=e("2877"),u=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,"7a671cad",null);n["default"]=u.exports},"5b41":function(t,n,e){"use strict";var o=function(){var t=this,n=t.$createElement;t._self._c},i=[];e.d(n,"a",function(){return o}),e.d(n,"b",function(){return i})},d333:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e("2f62");function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function a(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(e,!0).forEach(function(n){r(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(e).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function r(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var u={data:function(){return{success:!1,lose:!1,_num:0,more:!1,setting:{},coupon:[],userInfo:{integral:0},choose:{integral:0},banners:[],cats:[],id:0,exchangeCoupon:!1,current:"wechat",goods:[],args:!1,page:1}},computed:a({},(0,o.mapState)({theme:function(t){return t.mallConfig.theme},integralImg:function(t){return t.mallConfig.plugin.integral_mall},appSetting:function(t){return t.mallConfig.mall.setting},appImg:function(t){return t.mallConfig.__wxapp_img.mall}}),{},(0,o.mapGetters)("mallConfig",{getVideo:"getVideo"})),methods:{close:function(){this.success=!1,this.lose=!1},tab:function(t){this._num=t,this.page=1,this.goods=[],this.getGoods()},submit:function(){var n=this,e=n.choose.id;n.choose={},null!=n.userInfo&&n.userInfo.integral<n.choose.integral_num?t.showToast({title:"积分不足",icon:"none",duration:1e3}):(t.showLoading({title:"领取中..."}),n.$request({url:n.$api.integral_mall.coupon_submit,data:{id:e},method:"post"}).then(function(e){if(0==e.code){var o=e.data.queue_id,i=e.data.token;n.getPayOrderId(o,i)}else t.showToast({title:e.msg,icon:"none",duration:1e3})}).catch(function(n){t.hideLoading()}))},getPayOrderId:function(n,e){var o=this;this.$request({url:this.$api.integral_mall.coupon_pay,data:{queue_id:n,token:e}}).then(function(i){0===i.code?i.data.retry&&1===i.data.retry?o.getPayDataTimer=setTimeout(function(){o.getPayOrderId(n,e)},1e3):(t.hideLoading(),o.pay(i.data.id)):(o.choose={},t.hideLoading(),t.showModal({title:"提示",content:i.msg,showCancel:!1}))}).catch(function(n){o.choose={},t.hideLoading(),t.showModal({title:"提示",content:n.errMsg,showCancel:!1})})},pay:function(n){var e=this;this.$payment.pay(n).then(function(t){e.success=!0}).catch(function(n){t.showToast({title:"支付失败",icon:"none",duration:1e3})})},chooseItem:function(t){this.choose=t},toList:function(){this.success=!1,t.navigateTo({url:"/pages/coupon/index/index"})},toGoods:function(n){console.log(n),n.goodsWarehouse.video_url&&1==this.getVideo?t.navigateTo({url:"/pages/goods/video?goods_id=".concat(n.id,"&sign=").concat(n.sign)}):t.navigateTo({url:"/plugins/integral_mall/goods/goods?goods_id="+n.id})},toCoupon:function(n){t.navigateTo({url:"/plugins/integral_mall/coupon/coupon?id="+n})},toAbout:function(){t.navigateTo({url:"/plugins/integral_mall/about/about"})},toExchange:function(){t.navigateTo({url:"/plugins/integral_mall/exchange/exchange"})},toDetail:function(){t.navigateTo({url:"/pages/user-center/integral-detail/integral-detail"})},getList:function(){var n=this;n.$request({url:n.$api.integral_mall.index}).then(function(e){n.$hideLoading(),0==e.code?(n.banners=e.data.banners,n.setting=e.data.setting,n.userInfo=e.data.userInfo):t.showToast({title:e.msg,icon:"none",duration:1e3})}).catch(function(t){n.$hideLoading()})},getCoupon:function(){var n=this;n.$request({url:n.$api.integral_mall.coupon}).then(function(e){n.$hideLoading(),0==e.code?n.coupon=e.data.list:t.showToast({title:e.msg,icon:"none",duration:1e3})}).catch(function(t){n.$hideLoading()})},getCat:function(){var n=this;n.$request({url:n.$api.integral_mall.cats}).then(function(e){n.$hideLoading(),0==e.code?n.cats=e.data.list:t.showToast({title:e.msg,icon:"none",duration:1e3})}).catch(function(t){n.$hideLoading()})},getGoods:function(){var n=this;n.$request({url:n.$api.integral_mall.goods,data:{cat_id:n._num,page:n.page}}).then(function(e){n.$hideLoading(),0==e.code?(n.more=!1,e.data.list.length==e.data.pagination.pageSize&&(n.page++,n.more=!0),n.page>1?n.goods=n.goods.concat(e.data.list):n.goods=e.data.list):t.showToast({title:e.msg,icon:"none",duration:1e3})}).catch(function(t){n.$hideLoading()})}},onReachBottom:function(){this.more&&this.getGoods()},onLoad:function(t){var n=this;n._num=0,n.$showLoading({type:"global",text:"加载中..."}),n.getList(),n.getCoupon(),n.getCat(),n.getGoods()}};n.default=u}).call(this,e("c11b")["default"])}},[["e32e","common/runtime","common/vendor"]]]);